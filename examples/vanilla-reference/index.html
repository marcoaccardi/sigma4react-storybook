<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Vanilla Sigma.js Examples - Reference</title>
  <script src="https://cdn.jsdelivr.net/npm/graphology@0.26.0/dist/graphology.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sigma@3.0.2/dist/sigma.min.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
      background: #f5f5f5;
      height: 100vh;
      display: flex;
      flex-direction: column;
    }

    .header {
      background: #1a1a1a;
      color: white;
      padding: 20px;
      border-bottom: 1px solid #333;
    }

    .header h1 {
      font-size: 24px;
      margin-bottom: 10px;
    }

    .header p {
      color: #888;
      font-size: 14px;
    }

    .controls {
      background: white;
      padding: 15px 20px;
      border-bottom: 1px solid #ddd;
      display: flex;
      gap: 20px;
      align-items: center;
    }

    .controls label {
      font-weight: 600;
      font-size: 14px;
    }

    .controls select {
      padding: 8px 12px;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 14px;
      min-width: 300px;
    }

    .controls button {
      padding: 8px 16px;
      background: #3b82f6;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
    }

    .controls button:hover {
      background: #2563eb;
    }

    .main {
      flex: 1;
      display: flex;
      overflow: hidden;
    }

    .example-container {
      flex: 1;
      position: relative;
      background: white;
    }

    #sigma-container {
      width: 100%;
      height: 100%;
    }

    .info {
      position: absolute;
      top: 20px;
      right: 20px;
      background: rgba(255, 255, 255, 0.95);
      padding: 15px;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      max-width: 300px;
      font-size: 13px;
      line-height: 1.6;
    }

    .info h3 {
      margin-bottom: 10px;
      color: #1a1a1a;
    }

    .info p {
      color: #666;
    }

    .console {
      width: 350px;
      background: #1a1a1a;
      color: #fff;
      padding: 20px;
      overflow-y: auto;
      font-family: 'Courier New', monospace;
      font-size: 12px;
    }

    .console h3 {
      margin-bottom: 10px;
      color: #3b82f6;
    }

    .console-entry {
      margin-bottom: 8px;
      padding: 5px;
      background: #2a2a2a;
      border-radius: 3px;
    }

    .console-entry.event {
      border-left: 3px solid #3b82f6;
    }

    .console-entry.info {
      border-left: 3px solid #10b981;
    }
  </style>
</head>
<body>
  <div class="header">
    <h1>Vanilla Sigma.js Examples</h1>
    <p>Reference implementations for converting to React TypeScript</p>
  </div>

  <div class="controls">
    <label for="example-select">Select Example:</label>
    <select id="example-select">
      <option value="basic">Basic Graph</option>
      <option value="events">Event Handling</option>
      <option value="hover">Node Hover Effects</option>
    </select>
    <button onclick="clearConsole()">Clear Console</button>
  </div>

  <div class="main">
    <div class="example-container">
      <div id="sigma-container"></div>
      <div class="info">
        <h3 id="example-title">Basic Graph</h3>
        <p id="example-description">Simple graph with nodes and edges</p>
      </div>
    </div>
    <div class="console">
      <h3>Console Output</h3>
      <div id="console-output"></div>
    </div>
  </div>

  <script>
    // Global variables
    let sigma = null;
    const Graph = window.graphology.Graph;

    // Console logging
    function log(message, type = 'info') {
      const output = document.getElementById('console-output');
      const entry = document.createElement('div');
      entry.className = `console-entry ${type}`;
      entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
      output.appendChild(entry);
      output.scrollTop = output.scrollHeight;
    }

    function clearConsole() {
      document.getElementById('console-output').innerHTML = '';
    }

    // Destroy existing sigma instance
    function destroySigma() {
      if (sigma) {
        sigma.kill();
        sigma = null;
        document.getElementById('sigma-container').innerHTML = '';
      }
    }

    // Example implementations
    const examples = {
      basic: {
        title: 'Basic Graph',
        description: 'Simple graph with nodes and edges',
        run: () => {
          const graph = new Graph();

          // Add nodes
          graph.addNode("1", {
            x: 0,
            y: 0,
            size: 15,
            label: "Node 1",
            color: "#3388ff",
          });

          graph.addNode("2", {
            x: 1,
            y: 1,
            size: 20,
            label: "Node 2",
            color: "#ff8833",
          });

          graph.addNode("3", {
            x: -1,
            y: 0.5,
            size: 10,
            label: "Node 3",
            color: "#88ff33",
          });

          // Add edges
          graph.addEdge("1", "2", { size: 3, color: "#ccc" });
          graph.addEdge("2", "3", { size: 3, color: "#ccc" });
          graph.addEdge("3", "1", { size: 3, color: "#ccc" });

          // Create sigma instance
          const container = document.getElementById("sigma-container");
          sigma = new Sigma(graph, container, {
            renderLabels: true,
            labelSize: 12,
            labelColor: { color: "#000" },
          });

          log(`Graph created with ${graph.order} nodes and ${graph.size} edges`, 'info');
        }
      },

      events: {
        title: 'Event Handling',
        description: 'Click and hover events on nodes and edges',
        run: () => {
          const graph = new Graph();

          // Create a circle of nodes
          const numNodes = 8;
          for (let i = 0; i < numNodes; i++) {
            const angle = (i * 2 * Math.PI) / numNodes;
            graph.addNode(`node${i}`, {
              x: Math.cos(angle),
              y: Math.sin(angle),
              size: 10,
              label: `Node ${i}`,
              color: "#3388ff",
            });
          }

          // Connect adjacent nodes
          for (let i = 0; i < numNodes; i++) {
            graph.addEdge(`node${i}`, `node${(i + 1) % numNodes}`);
          }

          const container = document.getElementById("sigma-container");
          sigma = new Sigma(graph, container, {
            renderLabels: true,
            labelSize: 10,
            enableEdgeClickEvents: true,
            enableEdgeHoverEvents: true,
          });

          // Node events
          sigma.on("clickNode", (event) => {
            log(`Clicked: ${event.node}`, 'event');
          });

          sigma.on("enterNode", (event) => {
            log(`Hover enter: ${event.node}`, 'event');
          });

          sigma.on("leaveNode", (event) => {
            log(`Hover leave: ${event.node}`, 'event');
          });

          // Edge events
          sigma.on("clickEdge", (event) => {
            log(`Edge clicked: ${event.edge}`, 'event');
          });

          // Stage events
          sigma.on("clickStage", () => {
            log('Clicked on empty space', 'event');
          });

          log('Event handlers registered. Try clicking nodes, edges, or empty space!', 'info');
        }
      },

      hover: {
        title: 'Node Hover Effects',
        description: 'Highlight nodes and neighbors on hover using reducers',
        run: () => {
          const graph = new Graph();

          // Create a more complex graph
          const numNodes = 12;
          for (let i = 0; i < numNodes; i++) {
            const angle = (i * 2 * Math.PI) / numNodes;
            graph.addNode(`node${i}`, {
              x: Math.cos(angle) * 2,
              y: Math.sin(angle) * 2,
              size: 8,
              label: `Node ${i}`,
              color: "#3388ff",
            });
          }

          // Create some connections
          for (let i = 0; i < numNodes; i++) {
            graph.addEdge(`node${i}`, `node${(i + 1) % numNodes}`);
            graph.addEdge(`node${i}`, `node${(i + 3) % numNodes}`);
          }

          let hoveredNode = null;

          const container = document.getElementById("sigma-container");
          sigma = new Sigma(graph, container, {
            renderLabels: true,
            labelSize: 10,
            nodeReducer: (node, data) => {
              const res = { ...data };

              if (hoveredNode) {
                if (node === hoveredNode) {
                  // Highlight hovered node
                  res.color = "#ff0000";
                  res.size = data.size * 1.5;
                } else if (graph.hasEdge(node, hoveredNode) || graph.hasEdge(hoveredNode, node)) {
                  // Highlight neighbors
                  res.color = "#ff8833";
                  res.size = data.size * 1.2;
                } else {
                  // Dim other nodes
                  res.color = "#ccc";
                }
              }

              return res;
            },
            edgeReducer: (edge, data) => {
              const res = { ...data };

              if (hoveredNode && !graph.extremities(edge).includes(hoveredNode)) {
                res.color = "#f0f0f0";
              }

              return res;
            },
          });

          sigma.on("enterNode", (event) => {
            hoveredNode = event.node;
            sigma.refresh();
            log(`Highlighting ${event.node} and neighbors`, 'event');
          });

          sigma.on("leaveNode", () => {
            hoveredNode = null;
            sigma.refresh();
            log('Hover cleared', 'event');
          });

          log('Hover over nodes to highlight them and their neighbors!', 'info');
        }
      }
    };

    // Load example
    function loadExample(exampleId) {
      destroySigma();
      clearConsole();

      const example = examples[exampleId];
      document.getElementById('example-title').textContent = example.title;
      document.getElementById('example-description').textContent = example.description;

      log(`Loading example: ${example.title}`, 'info');
      example.run();
    }

    // Event listeners
    document.getElementById('example-select').addEventListener('change', (e) => {
      loadExample(e.target.value);
    });

    // Load initial example
    loadExample('basic');
  </script>
</body>
</html>
